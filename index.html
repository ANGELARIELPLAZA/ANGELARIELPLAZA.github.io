<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Invitación de Boda — Recorrido en 6 secciones</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Beau+Rivage&family=Great+Vibes&family=Italianno&family=Tangerine:wght@400;700&display=swap"
    rel="stylesheet">
  <style>
    /* --------- Reset mínimo --------- */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    .card__media1 {
      display: block;
      max-width: 100%;
      height: auto;
    }

    .card__media2 {
      display: block;
      max-width: 100%;
      height: auto;
    }

    /* --------- Tipografía / Colores --------- */
    :root {
      --bg: #fffaf7;
      --text: #2c2c2c;
      --muted: #6b6b6b;
      --brand: #b57a6a;
      /* rosa tostado */
      --brand-2: #d9c6be;
      /* arena suave */
      --card: #ffffff;
      --shadow: 0 10px 24px rgba(0, 0, 0, .10);
      --radius: 18px;
    }

    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      scroll-behavior: smooth;
      /* apoyo para scrollIntoView */
    }

    /* --------- Layout con scroll-snap (ideal móvil) --------- */
    main {
      scroll-snap-type: y mandatory;
      overflow-y: auto;
      height: 100dvh;
      /* 100% de viewport dinámico en móvil */
    }

    section.section {
      min-height: 45dvh;
      display: grid;
      place-items: center;
      padding: 0;
      scroll-snap-align: start;
      scroll-snap-stop: always;
      position: relative;
    }

    /* --------- Tarjetas --------- */
    .card {
      width: 98.8vw;
      height: 100%;
      /* ocupa todo el ancho */
      background: var(--card);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      flex-direction: column;
      align-items: center;
      text-align: center;
      color: white;
      background: rgba(0, 0, 0, 0.35);
      padding: 20px;
    }

    blockquote {
      font-style: italic;
      font-size: 1rem;
      margin: 0 0 20px 0;
    }

    .quote-text {
      color: var(--bg);
      font-size: 2.2rem;
      font-family: 'Playfair Display', serif;
      padding: 10% 0 0 0;

    }

    .quote-ref {
      margin-top: 8px;
      font-size: 0.9rem;
      opacity: 0.8;
    }


    .iniciales {
      font-weight: 700;
      margin: 10px 0;
      font-size: clamp(6.5rem, 10vw, 12rem);
      font-family: 'ui-sans-serif';
    }


    .textnoscasamos {
      font-family: 'Tangerine', cursive;
      font-size: 2.5rem;
      margin: 10px 0 20px;
    }


    .countdown {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .box {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 10px 14px;
      text-align: center;
      min-width: 60px;
    }

    .number {
      font-weight: bold;
      font-size: clamp(1.4rem, 3.5vw, 2.4rem);
      font-weight: 700;
    }

    .labelcount {
      font-size: clamp(1rem, 2vw, 1.1rem);
      letter-spacing: 1px;
      font-family: 'Tangerine', cursive;

    }

    .card__media {
      width: 100%;
      width: 100%;
      object-fit: cover;
      object-fit: cover;
    }


    .card__body {
      padding: clamp(16px, 3.5vw, 28px);
    }

    .family-header {
      text-align: center;
      padding: 20px 16px 0 16px;
    }

    .family-title {
      font-size: clamp(2.05rem, 4vw, 2.8rem);
      font-weight: 700;
      color: var(--brand);
      letter-spacing: .06em;
      margin: 0 0 8px 0;
    }

    .eyebrow {
      text-transform: uppercase;
      letter-spacing: .12em;
      font-size: .78rem;
      color: var(--brand);
      margin: 0 0 8px 0;
      font-weight: 700;
    }

    h2 {
      margin: 0 0 6px 0;
      font-size: clamp(1.4rem, 4.5vw, 2rem);
    }

    p {
      color: var(--muted);
      margin: 8px 0 0 0;
    }

    .start-wrap {
      margin: -137%;
    }

    /* --------- Indicador sutil --------- */
    .hint {
      position: fixed;
      top: 12px;
      right: 12px;
      background: rgba(0, 0, 0, .55);
      color: #fff;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: .8rem;
      z-index: 40;
      opacity: .0;
      transform: translateY(-8px);
      transition: opacity .4s ease, transform .4s ease;
      user-select: none;
    }

    .hint.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* El contenedor debe ser relativo para posicionar hijos absolutos */
    .card.card--hero {
      position: relative;
    }

    /* La foto de fondo principal queda en el nivel 1 */
    .card--hero .card__media.sec1 {
      position: relative;
      z-index: 1;
    }

    /* La flor (primera imagen) va por encima de la foto */
    .flower {
      position: absolute;
      z-index: 3;
      /* > 1 para estar encima de .card__media */
      pointer-events: none;
      /* para no bloquear toques/clics */
      display: block;
    }

    /* Ubícala en la esquina que quieras (top-left en este ejemplo) */
    .flower--tl {
      top: 0;
      left: 0;
    }

    /* Ya tienes el overlay en 4, se mantiene encima de todo */
    .card--hero .overlay {
      z-index: 4;
    }

    /* ===== DONDE & CUANDO ===== */

    /* ===== Sección 2 (Dónde & Cuándo) ===== */


    .textnoscasamos2 {
      font-size: clamp(1.35rem, 3vw, 2.4rem);
      font-weight: 600;
      color: var(--black);
      letter-spacing: .02em;
      background: #eeece9;
      box-shadow: var(--shadow);

    }

    .textnoscasamos3 {
      font-size: clamp(1.35rem, 3vw, 2.4rem);
      font-weight: 600;
      color: var(--black);
      letter-spacing: .02em;
      background: #eeece9;

    }

    /* Grid de padres */
    .parents-block {
      max-width: 1000px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .parents-col {
      background: #f9f7f4;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 16px;
    }

    .parents-col--full {
      grid-column: 1 / -1;
    }

    .parents-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--brand);
      letter-spacing: .08em;
      margin: 0 0 8px;
    }

    .parents-list {
      list-style: none;
      padding: 0;
      margin: 0;
      color: var(--black);
      line-height: 1.6;
      font-size: 1.05rem;
    }

    .novios-list {
      list-style: none;
      padding: 0;
      margin: 0;
      color: var(--dorado);
      line-height: 1.6;
      font-size: 5.4rem;
      align-items: center;
    }

    .textnoscasamos4 {
      list-style: none;
      padding: 0;
      margin: 0;
      line-height: 1.6;
      font-size: 4.4rem;
      align-items: center;
    }

    .textnoscasamos4 p {

      color: var(--brand);
    }

    .parents-list .amp {
      font-weight: 700;
      color: var(--brand);
      font-size: 1.15rem;
      margin: 2px 0;
    }

    .invite-line {
      margin: 14px auto 10px;
      color: var(--muted);
      font-size: 1.8rem;
      font-family: 'Tangerine', cursive;
    }

    /* Dónde y Cuándo */
    .where-when {
      color: var(--brand);
      letter-spacing: .06em;
      font-weight: 700;
      font-size: clamp(1.2rem, 2.6vw, 1.5rem);
      margin: 18px 0 16px;
    }

    /* Event + Map grid */
    .event-grid {
      max-width: 1000px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1.15fr;
      gap: 22px;
      align-items: stretch;
    }

    .event-card {
      background: var(--card);
      border: 1px solid #eadfd3;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 14px;
      text-align: left;
    }

    .event-date {
      background: #f5efe9;
      color: var(--brand);
      border-radius: 12px;
      width: 96px;
      min-width: 96px;
      padding: 10px 8px;
      display: grid;
      place-items: center;
      line-height: 1;
    }

    .event-date .day {
      font-size: 4rem;
      font-weight: 700;
      font-family: 'Great Vibes', cursive;

    }

    .event-date .month {
      font-size: 2rem;
      letter-spacing: .14em;
      font-family: 'Great Vibes', cursive;

    }

    .event-date .year {
      font-size: 2rem;
      letter-spacing: .12em;
      color: #8f806f;
      font-family: 'Great Vibes', cursive;

    }

    .event-info .event-title {
      font-weight: 800;
      font-size: 1.5rem;
      color: var(--brand);
      letter-spacing: .06em;
      margin: 2px 0 6px;
    }

    .event-info .event-time {
      font-size: 2.5rem;
      color: #5f5a54;
      margin: 0 0 6px;
      letter-spacing: .04em;
      font-family: 'Tangerine', cursive;

    }

    .event-info {
      display: grid;
      place-items: center;
      /* centra horizontal y vertical */
      text-align: center;
    }

    .event-info .font-beau {
      text-align: center;
    }

    .event-info .event-place {
      font-size: 1.5rem;
      color: var(--black);
      line-height: 1.5;
      margin: 0;
    }

    /* Mapa responsive */
    .map-wrap {
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      background: #eee;
      aspect-ratio: 4 / 3;
    }

    .map-wrap iframe {
      width: 100%;
      height: 100%;
      border: 0;
    }

    .section2 {
      display: flex;
      flex-direction: column;
      justify-content: center;
      /* centra verticalmente */
      align-items: center;
      /* centra horizontalmente */
      text-align: center;
      /* centra el texto */
      min-height: 100vh;
      /* ocupa toda la pantalla */
      padding: 2rem;
      background-color: var(--bg, #fffaf7);
    }

    /* Para centrar correctamente los bloques internos */
    .section2 .parents-block,
    .section2 .event-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      width: 100%;
    }

    /* Si tus columnas de padres usan grid o flex, asegúrate de centrar también */
    .parents-col {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    /* Centrar mapa e imagen */
    .map-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    /* Opcional: ajusta el scroll hint */
    .scroll-hint {
      margin-top: 2rem;
      text-align: center;
    }


    /* Hover sutil */
    .event-card:hover {
      transform: translateY(-1px);
      transition: transform .2s ease;
    }

    /* Typography helpers */
    .font-italianno {
      font-family: 'Italianno', cursive;
    }

    .font-beau {
      font-family: 'Beau Rivage', cursive;
    }

    .font-great {
      font-family: 'Great Vibes', cursive;
    }

    .font-tangerine {
      font-family: 'Tangerine', cursive;
    }


    .start-btn {
      pointer-events: auto;
      /* clickeable */
      background-color: #b57a6a;
      color: #fff;
      font-weight: 700;
      border: none;
      border-radius: 999px;
      padding: 14px 26px;
      font-size: 1.1rem;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease, background 0.2s ease;
    }

    .start-btn:hover {
      background-color: #a56a5e;
      transform: scale(1.05);
    }
  </style>
</head>

<body>
  <!-- Indicador (aparece cuando inicia el recorrido) -->
  <div id="hint" class="hint">Recorrido en curso… toca para pausar</div>

  <!-- Contenido con scroll-snap -->
  <main id="root">

    <!-- Sección 1: Portada -->
    <section class="section" id="s1">
      <article class="card card--hero">

        <img src="./img/Fondo_portada_arriba.png" alt="" class="card__media2  flower flower--tl" aria-hidden="true"
          role="presentation">

        <!-- Esta es la imagen grande de fondo -->
        <img class="card__media1" alt="Pareja al atardecer" src="./img/IMAGEN1.jpeg" />

        <div class="overlay">
          <blockquote>
            <p class="quote-text">“Mi amado es mío, y yo soy suya.”</p>
            <footer class="quote-ref">— Cantares 2:16</footer>
          </blockquote>
          <h1 class="iniciales" aria-label="Iniciales de los novios">S|A</h1>
          <h2 class="textnoscasamos">¡Nos casamos!</h2>
          <div class="countdown" id="countdown">
            <div class="box">
              <div class="number" id="days">00</div>
              <div class="labelcount">Días</div>
            </div>
            <div class="box">
              <div class="number" id="hours">00</div>
              <div class="labelcount">Horas</div>
            </div>
            <div class="box">
              <div class="number" id="minutes">00</div>
              <div class="labelcount">Min</div>
            </div>
            <div class="box">
              <div class="number" id="seconds">00</div>
              <div class="labelcount">Seg</div>
            </div>
          </div>
          <!-- Botón de inicio/pausa del recorrido -->
          <div class="start-wrap">
            <button id="startBtn" class="start-btn" type="button" aria-controls="root">
              Iniciar recorrido
            </button>
          </div>

        </div>
      </article>
    </section>

    <!-- Sección 2: Cuándo y dónde / Familia -->
    <section id="s2" class="section" aria-labelledby="s2-title">
      <article class="card card--family">
        <!-- Decoración superior (decorativa) -->
        <picture aria-hidden="true">
          <source srcset="./img/Fondo_Sec2_arriba.png" media="(min-width: 768px)">
          <img class="card__media card__media--top" src="./img/Fondo_Sec2_arriba.png" alt="" loading="lazy"
            decoding="async">
        </picture>

        <header class="family-header">
          <h2 id="s2-title" class="family-title font-tangerine">Con la bendición de nuestros queridos padres</h2>
          <div class="family-divider" aria-hidden="true"></div>
        </header>

        <div class="parents-grid" aria-label="Padres de los novios">
          <!-- Padres de la novia -->
          <section class="parents-col" aria-labelledby="parents-bride">
            <h3 id="parents-bride" class="parents-title font-tangerine">Padres de la novia</h3>
            <ul class="parents-list">
              <li class="font-great">Crisóforo Molina H.</li>
              <li aria-hidden="true" class="amp font-italianno">&amp;</li>
              <li class="font-great">Enriqueta Cazarin L.</li>
            </ul>
          </section>

          <!-- Padres del novio -->
          <section class="parents-col" aria-labelledby="parents-groom">
            <h3 id="parents-groom" class="parents-title font-tangerine">Padres del novio</h3>
            <ul class="parents-list">
              <li class="font-great">Ángel Alberto Plaza R.</li>
              <li aria-hidden="true" class="amp font-italianno">&amp;</li>
              <li class="font-great">Ángela Janely Acuña G.</li>
            </ul>
          </section>
        </div>

        <!-- Novios -->
        <div class="couple-wrap" aria-live="polite">
          <p class="couple-eyebrow">Nosotros</p>
          <p class="couple-names font-italianno">Sinai <span class="amp" aria-hidden="true">&amp;</span> Ariel</p>
        </div>

        <p class="invite-line">
          Con gran alegría, les invitamos a compartir un nuevo capítulo de nuestra historia de amor:
        </p>
        <p class="invite-cta font-italianno">Nuestra boda.</p>

        <!-- Decoración inferior (decorativa) -->
        <picture aria-hidden="true">
          <source srcset="./img/Fondo_Sec2_abajo.png" media="(min-width: 768px)">
          <img class="card__media card__media--bottom" src="./img/Fondo_Sec2_abajo.png" alt="" loading="lazy"
            decoding="async">
        </picture>
      </article>
    </section>


    <!-- Sección 3: Ceremonia -->
    <section class="section" id="s3">
      <article class="card">
        <img class="card__media" alt="Iglesia elegante"
          src="https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=1600&auto=format&fit=crop" />
        <div class="card__body">
          <p class="eyebrow">Ceremonia</p>
          <h2>Parroquia de San Miguel</h2>
          <p>4:00 PM — Agradecemos llegar con 15 minutos de anticipación para acomodar a todos.</p>
        </div>
      </article>
    </section>

    <!-- Sección 4: Recepción -->
    <section class="section" id="s4">
      <article class="card">
        <img class="card__media" alt="Recepción al aire libre"
          src="https://images.unsplash.com/photo-1482707272725-473c4f3de1f7?q=80&w=1600&auto=format&fit=crop" />
        <div class="card__body">
          <p class="eyebrow">Recepción</p>
          <h2>Banquete &amp; Celebración</h2>
          <p>Después de la ceremonia, acompáñanos a disfrutar de una noche inolvidable con música, baile y mucha
            alegría.</p>
        </div>
      </article>
    </section>

    <!-- Sección 5: Dress Code -->
    <section class="section" id="s5">
      <article class="card">
        <img class="card__media" alt="Vestimenta formal"
          src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?q=80&w=1600&auto=format&fit=crop" />
        <div class="card__body">
          <p class="eyebrow">Dress Code</p>
          <h2>Formal de Jardín</h2>
          <p>Colores sugeridos: neutros, pastel o tierra. Evitar blanco total.</p>
        </div>
      </article>
    </section>

    <!-- Sección 6: Confirmación (RSVP) -->
    <section class="section" id="s6">
      <article class="card">
        <img class="card__media" alt="Tarjeta RSVP"
          src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=1600&auto=format&fit=crop" />
        <div class="card__body">
          <p class="eyebrow">¡Te esperamos!</p>
          <h2>Confirma tu asistencia</h2>
          <p>Escríbenos o confirma en el enlace que te compartimos. ¡Gracias por acompañarnos!</p>
        </div>
      </article>
    </section>
    <!-- Sección 3 (Itinerario) -->
    <section class="section" id="s7">

      <h2 class="font-tangerine">Itinerario</h2>
      <img src="./img/flor_2.png" alt="" class="flower2 flower--bl" aria-hidden="true" role="presentation">

      <div class="timeline">
        <div class="timeline-item left">
          <div class="timeline-content">
            <h3>04:00 pm</h3>
            <img src="./icons/wedding-arch.png" alt="Icono ceremonia civil" class="timeline-icon">
            <p>Ceremonia civil</p>
          </div>
        </div>

        <div class="timeline-item right">
          <div class="timeline-content">
            <h3>05:00 pm</h3>
            <img src="./icons/wine.png" alt="Icono recepción" class="timeline-icon">
            <p>Recepción</p>
          </div>
        </div>

        <div class="timeline-item left">
          <div class="timeline-content">
            <h3>07:00 pm</h3>
            <img src="./icons/restaurant.png" alt="Icono cena" class="timeline-icon">
            <p>Cena</p>
          </div>
        </div>

        <div class="timeline-item right">
          <div class="timeline-content">
            <h3>09:00 pm</h3>
            <img src="./icons/dance.png" alt="Icono baile" class="timeline-icon">
            <p>Bailes</p>
          </div>
        </div>

      </div>
    </section>

    <!-- Sección 4 (Galería) -->
    <section class="section" id="s8">
      <h2 class="font-tangerine">Momentos</h2>
      <div class="g-stack-wrap">
        <div class="g-stack" id="gStack" aria-live="polite">
          <div class="g-card"><img src="./img/IMG1.jpeg" alt="Foto 1"></div>
          <div class="g-card"><img src="./img/IMG2.jpeg" alt="Foto 2"></div>
          <div class="g-card"><img src="./img/IMG3.jpeg" alt="Foto 3"></div>
          <div class="g-card"><img src="./img/IMG4.jpeg" alt="Foto 4"></div>
          <div class="g-card"><img src="./img/IMG5.jpeg" alt="Foto 5"></div>
          <div class="g-card"><img src="./img/IMG6.jpeg" alt="Foto 6"></div>
          <div class="g-card"><img src="./img/IMG7.jpeg" alt="Foto 7"></div>
          <div class="g-card"><img src="./img/IMG8.jpeg" alt="Foto 8"></div>
          <div class="g-card"><img src="./img/IMG9.jpeg" alt="Foto 9"></div>
          <div class="g-card"><img src="./img/IMG10.jpeg" alt="Foto 10"></div>
          <div class="g-card"><img src="./img/IMG11.jpeg" alt="Foto 11"></div>
        </div>
        <div class="g-hint">Desliza a la izquierda o derecha para ver las fotos</div>
        <div class="g-actions">
          <button class="g-btn" id="gReset" type="button">⟲ Reiniciar</button>
        </div>
        <div class="g-empty" id="gEmpty" style="display:none">¡Sin más fotos! Presiona “Reiniciar”.</div>
      </div>
      <div class="scroll-hint">Desliza hacia abajo</div>

    </section>

    <!-- Sección 5 — Código de Vestimenta -->
    <img src="./img/Fondo_portada_arriba.png" alt="" class="flower3 mirror-x" aria-hidden="true" role="presentation">
    <section class="section" id="s9">
      <div class="dc-in">
        <h2 class="dc-eyebrow">Código de Vestimenta:</h2>
        <p class="dc-style" id="dc-title">Formal</p>
        <p class="dc-note"><span class="dc-highlight">Evitar</span> vestimenta completa de los siguientes colores:</p>

        <ul class="dc-grid" role="list" aria-label="Colores a evitar">
          <li class="dc-chip" aria-label="Blanco">
            <span class="dc-swatch dc-white"><span class="dc-x">✕</span></span>
            <span class="dc-chip-label">Blanco</span>
          </li>
          <li class="dc-chip" aria-label="Verde olivo claro">
            <span class="dc-swatch dc-olive"><span class="dc-x">✕</span></span>
            <span class="dc-chip-label">Verde olivo claro</span>
          </li>
          <li class="dc-chip" aria-label="Beige / arena">
            <span class="dc-swatch dc-beige"><span class="dc-x">✕</span></span>
            <span class="dc-chip-label">Beige / arena</span>
          </li>
          <li class="dc-chip" aria-label="Azul marino">
            <span class="dc-swatch dc-navy"><span class="dc-x">✕</span></span>
            <span class="dc-chip-label">Azul marino</span>
          </li>
        </ul>
      </div>
      <div class="scroll-hint">Desliza hacia abajo</div>

    </section>

    <!-- Sección 6 (RSVP) -->
    <section class="section" id="s9">
      <div class="card">
        <div class="card-body">
          <div class="card-title">Tu presencia es muy importante para nosotros, por lo que nos gustaría que nos
            confirmaras antes del 2 de diciembre</div>
          <div class="actions">
            <a href="https://wa.me/5219211024671?text=%C2%A1Hola!%20Quiero%20confirmar%20mi%20asistencia%20a%20la%20boda.%20Mi%20nombre%20es%20[Tu%20Nombre]."
              target="_blank" rel="noopener" class="btn">
              Confirmar por WhatsApp
            </a>
          </div>
        </div>
        <img src="./img/Fondo_Sec2_abajo.png" alt="" class="flower-bg" aria-hidden="true">
      </div>
    </section>
  </main>


<script>
(function () {
  // ====== Referencias básicas ======
  const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)');
  const root = document.getElementById('root');
  const startBtn = document.getElementById('startBtn');
  const hint = document.getElementById('hint');

  if (!root || !startBtn) {
    // Si falta algo crítico, no hacemos nada para evitar errores
    console.warn('[tour] Falta #root o #startBtn');
    return;
  }

  const sections = Array.from(root.querySelectorAll('.section'));

  // ====== Estado del recorrido ======
  let running = false;
  let stopRequested = false;

  // ====== Utilidades ======
  const sleep = (ms) => new Promise(r => setTimeout(r, ms));

  function showHint(show) {
    if (!hint) return;
    hint.classList.toggle('show', !!show);
  }

  // Espera hasta que el contenedor deje de moverse o se agote el tiempo
  function waitForSettle(timeoutMs) {
    return new Promise((resolve) => {
      const start = performance.now();
      let lastY = root.scrollTop;
      let sameCount = 0;

      function tick() {
        if (stopRequested) { resolve(true); return; }

        const now = performance.now();
        const y = root.scrollTop;

        if (Math.abs(y - lastY) < 0.5) {
          sameCount++;
          if (sameCount > 6) { resolve(true); return; }
        } else {
          sameCount = 0;
          lastY = y;
        }

        if (now - start > timeoutMs) { resolve(false); return; }
        requestAnimationFrame(tick);
      }

      requestAnimationFrame(tick);
    });
  }

  // Identifica la sección más visible para arrancar desde allí
  function getStartIndex() {
    let startIndex = 0;
    let bestRatio = 0;
    const viewportH = window.innerHeight || document.documentElement.clientHeight;

    sections.forEach((sec, i) => {
      const rect = sec.getBoundingClientRect();
      const visible = Math.max(0, Math.min(rect.bottom, viewportH) - Math.max(rect.top, 0));
      const ratio = visible / Math.max(1, rect.height);
      if (ratio > bestRatio) { bestRatio = ratio; startIndex = i; }
    });

    return startIndex;
  }

  // ====== Recorrido automático ======
  async function autoTour() {
    if (prefersReduced.matches) return; // respeta accesibilidad

    running = true;
    stopRequested = false;
    showHint(true);
    startBtn.textContent = 'Pausar recorrido';

    const startIndex = getStartIndex();

    for (let i = startIndex; i < sections.length; i++) {
      if (stopRequested) break;

      sections[i].scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Espera a que el scroll se asiente, luego una pequeña pausa
      const settled = await waitForSettle(1400);
      if (!settled) await sleep(600);
      await sleep(800);
    }

    running = false;
    stopRequested = false;
    showHint(false);
    startBtn.textContent = 'Repetir recorrido';
  }

  // ====== Interacciones ======
  startBtn.addEventListener('click', () => {
    if (!running) {
      autoTour();
    } else {
      stopRequested = true;
      showHint(false);
      startBtn.textContent = 'Reanudar recorrido';
    }
  });

  // Tocar la pantalla también pausa (móvil friendly)
  root.addEventListener('pointerdown', () => {
    if (running) {
      stopRequested = true;
      showHint(false);
      startBtn.textContent = 'Reanudar recorrido';
    }
  }, { passive: true });

  // Evita que el teclado (iOS) rompa el snap mientras se escribe
  window.addEventListener('focusin', (e) => {
    if (e.target && (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA')) {
      root.style.scrollSnapType = 'none';
    }
  });
  window.addEventListener('focusout', () => { root.style.scrollSnapType = 'y mandatory'; });

  // Pausa si la pestaña pierde foco (opcional, mejora UX)
  document.addEventListener('visibilitychange', () => {
    if (document.hidden && running) {
      stopRequested = true;
      showHint(false);
      startBtn.textContent = 'Reanudar recorrido';
    }
  });

  // ====== Cuenta regresiva ======
  (function setupCountdown() {
    const countdownEl = document.getElementById('countdown');
    if (!countdownEl) return;

    const dEl = document.getElementById('days');
    const hEl = document.getElementById('hours');
    const mEl = document.getElementById('minutes');
    const sEl = document.getElementById('seconds');

    // Ajusta la fecha/hora de tu evento:
    const countdownDate = new Date('2025-11-15T17:00:00').getTime();

    const timer = setInterval(() => {
      const now = Date.now();
      const distance = countdownDate - now;

      if (distance < 0) {
        clearInterval(timer);
        countdownEl.innerHTML = '<p>¡Llegó el gran día!</p>';
        return;
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      if (dEl) dEl.textContent = String(days).padStart(2, '0');
      if (hEl) hEl.textContent = String(hours).padStart(2, '0');
      if (mEl) mEl.textContent = String(minutes).padStart(2, '0');
      if (sEl) sEl.textContent = String(seconds).padStart(2, '0');
    }, 1000);
  })();
})();
</script>

</body>

</html>